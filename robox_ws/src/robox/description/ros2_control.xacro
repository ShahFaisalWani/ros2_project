<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <ros2_control name="diffbot_control" type="system">
    
    <hardware>
      <plugin>diffdrive_gpio/DiffDriveGPIOHardware</plugin>
      
      <!-- Hardware configuration parameters for GPIO -->
      <param name="left_wheel_name">left_wheel_joint</param>
      <param name="right_wheel_name">right_wheel_joint</param>

      <!-- GPIO pin numbers for both encoder channels and motors -->
      <param name="gpio_left_encoder_a">5</param>   <!-- GPIO pin for left encoder (Channel A) -->
      <param name="gpio_left_encoder_b">6</param>   <!-- GPIO pin for left encoder (Channel B) -->
      <param name="gpio_right_encoder_a">20</param> <!-- GPIO pin for right encoder (Channel A) -->
      <param name="gpio_right_encoder_b">21</param> <!-- GPIO pin for right encoder (Channel B) -->
      <param name="gpio_left_motor">22</param>      <!-- GPIO pin for left motor -->
      <param name="gpio_right_motor">23</param>     <!-- GPIO pin for right motor -->

      <!-- Other configuration parameters -->
      <param name="loop_rate">50.0</param>        <!-- Control loop rate in Hz -->
      <param name="enc_counts_per_rev">660</param> <!-- Encoder counts per revolution -->
    </hardware>

    <!-- Joint definitions for left and right wheels -->
    <joint name="left_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>
    <joint name="right_wheel_joint">
      <command_interface name="velocity"/>
      <state_interface name="position"/>
      <state_interface name="velocity"/>
    </joint>

  </ros2_control>

</robot>
